# MCP 2025-11-25 Compliance Checklist

This document tracks MCP protocol compliance for `figma-mcp` against the
2025-11-25 JSON-RPC spec. It is a living checklist and should be updated
whenever protocol behavior changes.

## Transport

- [x] **stdio** server mode (JSON-RPC over stdin/stdout)
- [x] **HTTP JSON-RPC** (`POST /mcp` or `/`) with JSON response
- [x] **streamable-http (SSE)** `GET /mcp` with `event: endpoint`
- [x] **CORS preflight** `OPTIONS *`

References:
- `lib/mcp_protocol.ml`
- `lib/mcp_protocol_eio.ml`

## JSON-RPC Core

- [x] JSON-RPC 2.0 validation (`jsonrpc == "2.0"`, `method` required)
- [x] Error codes: parse, invalid request, method not found, invalid params, internal error
- [x] Notification handling (`id` missing or null)

References:
- `lib/mcp_protocol.ml`

## Lifecycle

- [x] `initialize`
- [x] `initialized` / `notifications/initialized`
- [x] `serverInfo` + `protocolVersion` in initialize result
- [x] `capabilities` in initialize result
- [x] `instructions` in initialize result

References:
- `lib/mcp_protocol.ml`

## Tools

- [x] `tools/list`
- [x] `tools/call`
- [x] Tool schema: name/description/inputSchema

References:
- `lib/mcp_protocol.ml`
- `lib/mcp_tools.ml`

## Resources

- [x] `resources/list`
- [x] `resources/read`
- [x] `resources/templates/list` (returns empty list)

References:
- `lib/mcp_protocol.ml`

## Prompts

- [x] `prompts/list`
- [x] `prompts/get`

References:
- `lib/mcp_protocol.ml`

## streamable-http (SSE)

- [x] `GET /mcp` keeps SSE connection alive
- [x] `event: endpoint` with query-bound `client_id`
- [x] `event: message` for JSON-RPC responses when `client_id` is present
- [x] `event: ping` keepalive
- [x] `notifications/shutdown` broadcast
- [x] Fallback: no `client_id` â†’ JSON response on `POST /mcp`

References:
- `lib/mcp_protocol_eio.ml`

## Optional / Not Implemented

These are not currently implemented. Add only if required by the spec
or needed by clients.

- [ ] `resources/subscribe` / `resources/unsubscribe`
- [ ] `prompts/listChanged` notification
- [ ] `resources/listChanged` notification
- [ ] Sampling / completion endpoints (if required by clients)
- [ ] Root discovery endpoints (if required by clients)

